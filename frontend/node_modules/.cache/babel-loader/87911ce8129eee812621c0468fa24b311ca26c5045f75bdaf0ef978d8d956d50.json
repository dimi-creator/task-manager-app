{"ast":null,"code":"var _jsxFileName = \"C:\\\\MAMP\\\\htdocs\\\\task-manager-app\\\\frontend\\\\src\\\\context\\\\AuthContext.js\",\n  _s = $RefreshSig$();\nimport React, { createContext, useState, useEffect, useCallback, useContext } from 'react';\nimport axios from 'axios';\nimport { useHistory } from 'react-router-dom';\nimport { toast } from 'react-toastify';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext();\nexport const AuthProvider = ({\n  children\n}) => {\n  _s();\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const history = useHistory();\n\n  // Vérifier l'état de connexion au chargement\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    const userData = localStorage.getItem('user');\n    if (token && userData) {\n      try {\n        setUser(JSON.parse(userData));\n        // Configurer l'en-tête d'authentification par défaut\n        axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n      } catch (error) {\n        console.error('Erreur lors du parsing des données utilisateur:', error);\n        localStorage.removeItem('token');\n        localStorage.removeItem('user');\n      }\n    }\n    setLoading(false);\n  }, []);\n\n  // Fonction de connexion\n  const login = useCallback(async credentials => {\n    try {\n      console.log('Tentative de connexion avec les identifiants :', credentials);\n      const response = await axios({\n        method: 'post',\n        url: 'http://127.0.0.1:8000/api/login',\n        data: {\n          email: credentials.email,\n          password: credentials.password,\n          device_name: 'browser' || credentials.device_name\n        },\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json'\n        },\n        withCredentials: true\n      });\n      console.log('Réponse du serveur:', response.data);\n      if (response.data && response.data.token && response.data.user) {\n        const {\n          token,\n          user\n        } = response.data;\n\n        // Stocker le token et les données utilisateur\n        localStorage.setItem('token', token);\n        localStorage.setItem('user', JSON.stringify(user));\n\n        // Configurer l'en-tête d'authentification par défaut\n        axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n\n        // Mettre à jour l'état utilisateur\n        setUser(user);\n\n        // Afficher le message de succès\n        toast.success('Connexion réussie !');\n        return {\n          success: true,\n          user\n        };\n      } else {\n        throw new Error('Réponse du serveur invalide');\n      }\n    } catch (error) {\n      console.error('Erreur de connexion:', error);\n      throw error;\n    }\n  }, []);\n\n  // Fonction de déconnexion\n  const logout = useCallback(() => {\n    // Supprimer les données d'authentification\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    delete axios.defaults.headers.common['Authorization'];\n    setUser(null);\n    toast.info('Vous avez été déconnecté avec succès');\n\n    // Rediriger vers la page de connexion\n    history.push('/login');\n  }, [history]);\n\n  // Fonction d'inscription\n  const register = useCallback(async userData => {\n    try {\n      const response = await axios.post('http://127.0.0.1:8000/api/register', {\n        ...userData,\n        password_confirmation: userData.password\n      });\n      toast.success('Inscription réussie ! Veuillez vous connecter.');\n      return {\n        success: true\n      };\n    } catch (error) {\n      console.error('Erreur lors de l\\'inscription:', error);\n      throw error;\n    }\n  }, []);\n\n  // Vérifier si l'utilisateur est authentifié\n  const isAuthenticated = !!user;\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      loading,\n      isAuthenticated,\n      login,\n      logout,\n      register\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 115,\n    columnNumber: 9\n  }, this);\n};\n_s(AuthProvider, \"8di1RvVO9OMJYUpZq8Z48NhIhRY=\", false, function () {\n  return [useHistory];\n});\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","useCallback","useContext","axios","useHistory","toast","jsxDEV","_jsxDEV","AuthContext","AuthProvider","children","_s","user","setUser","loading","setLoading","history","token","localStorage","getItem","userData","JSON","parse","defaults","headers","common","error","console","removeItem","login","credentials","log","response","method","url","data","email","password","device_name","withCredentials","setItem","stringify","success","Error","logout","info","push","register","post","password_confirmation","isAuthenticated","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/MAMP/htdocs/task-manager-app/frontend/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect, useCallback, useContext } from 'react';\nimport axios from 'axios';\nimport { useHistory } from 'react-router-dom';\nimport { toast } from 'react-toastify';\n\nexport const AuthContext = createContext();\n\nexport const AuthProvider = ({ children }) => {\n    const [user, setUser] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const history = useHistory();\n\n    // Vérifier l'état de connexion au chargement\n    useEffect(() => {\n        const token = localStorage.getItem('token');\n        const userData = localStorage.getItem('user');\n        \n        if (token && userData) {\n            try {\n                setUser(JSON.parse(userData));\n                // Configurer l'en-tête d'authentification par défaut\n                axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n            } catch (error) {\n                console.error('Erreur lors du parsing des données utilisateur:', error);\n                localStorage.removeItem('token');\n                localStorage.removeItem('user');\n            }\n        }\n        \n        setLoading(false);\n    }, []);\n\n    // Fonction de connexion\n    const login = useCallback(async (credentials) => {\n        try {\n            console.log('Tentative de connexion avec les identifiants :', credentials);\n            \n            const response = await axios({\n                method: 'post',\n                url: 'http://127.0.0.1:8000/api/login',\n                data: {\n                    email: credentials.email,\n                    password: credentials.password,\n                    device_name: 'browser' || credentials.device_name\n                },\n                headers: {\n                    'Accept': 'application/json',\n                    'Content-Type': 'application/json'\n                },\n                withCredentials: true\n            });\n            \n            console.log('Réponse du serveur:', response.data);\n            \n            if (response.data && response.data.token && response.data.user) {\n                const { token, user } = response.data;\n                \n                // Stocker le token et les données utilisateur\n                localStorage.setItem('token', token);\n                localStorage.setItem('user', JSON.stringify(user));\n                \n                // Configurer l'en-tête d'authentification par défaut\n                axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n                \n                // Mettre à jour l'état utilisateur\n                setUser(user);\n                \n                // Afficher le message de succès\n                toast.success('Connexion réussie !');\n                \n                return { success: true, user };\n            } else {\n                throw new Error('Réponse du serveur invalide');\n            }\n        } catch (error) {\n            console.error('Erreur de connexion:', error);\n            throw error;\n        }\n    }, []);\n\n    // Fonction de déconnexion\n    const logout = useCallback(() => {\n        // Supprimer les données d'authentification\n        localStorage.removeItem('token');\n        localStorage.removeItem('user');\n        delete axios.defaults.headers.common['Authorization'];\n        \n        setUser(null);\n        toast.info('Vous avez été déconnecté avec succès');\n        \n        // Rediriger vers la page de connexion\n        history.push('/login');\n    }, [history]);\n\n    // Fonction d'inscription\n    const register = useCallback(async (userData) => {\n        try {\n            const response = await axios.post('http://127.0.0.1:8000/api/register', {\n                ...userData,\n                password_confirmation: userData.password\n            });\n            \n            toast.success('Inscription réussie ! Veuillez vous connecter.');\n            return { success: true };\n        } catch (error) {\n            console.error('Erreur lors de l\\'inscription:', error);\n            throw error;\n        }\n    }, []);\n\n    // Vérifier si l'utilisateur est authentifié\n    const isAuthenticated = !!user;\n\n    return (\n        <AuthContext.Provider \n            value={{ \n                user, \n                loading, \n                isAuthenticated,\n                login, \n                logout, \n                register \n            }}\n        >\n            {children}\n        </AuthContext.Provider>\n    );\n};"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,aAAa,EAAEC,QAAQ,EAAEC,SAAS,EAAEC,WAAW,EAAEC,UAAU,QAAQ,OAAO;AAC1F,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,UAAU,QAAQ,kBAAkB;AAC7C,SAASC,KAAK,QAAQ,gBAAgB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEvC,OAAO,MAAMC,WAAW,gBAAGV,aAAa,CAAC,CAAC;AAE1C,OAAO,MAAMW,YAAY,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAAAC,EAAA;EAC1C,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAGd,QAAQ,CAAC,IAAI,CAAC;EACtC,MAAM,CAACe,OAAO,EAAEC,UAAU,CAAC,GAAGhB,QAAQ,CAAC,IAAI,CAAC;EAC5C,MAAMiB,OAAO,GAAGZ,UAAU,CAAC,CAAC;;EAE5B;EACAJ,SAAS,CAAC,MAAM;IACZ,MAAMiB,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAC3C,MAAMC,QAAQ,GAAGF,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC;IAE7C,IAAIF,KAAK,IAAIG,QAAQ,EAAE;MACnB,IAAI;QACAP,OAAO,CAACQ,IAAI,CAACC,KAAK,CAACF,QAAQ,CAAC,CAAC;QAC7B;QACAjB,KAAK,CAACoB,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAAG,UAAUR,KAAK,EAAE;MACtE,CAAC,CAAC,OAAOS,KAAK,EAAE;QACZC,OAAO,CAACD,KAAK,CAAC,iDAAiD,EAAEA,KAAK,CAAC;QACvER,YAAY,CAACU,UAAU,CAAC,OAAO,CAAC;QAChCV,YAAY,CAACU,UAAU,CAAC,MAAM,CAAC;MACnC;IACJ;IAEAb,UAAU,CAAC,KAAK,CAAC;EACrB,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMc,KAAK,GAAG5B,WAAW,CAAC,MAAO6B,WAAW,IAAK;IAC7C,IAAI;MACAH,OAAO,CAACI,GAAG,CAAC,gDAAgD,EAAED,WAAW,CAAC;MAE1E,MAAME,QAAQ,GAAG,MAAM7B,KAAK,CAAC;QACzB8B,MAAM,EAAE,MAAM;QACdC,GAAG,EAAE,iCAAiC;QACtCC,IAAI,EAAE;UACFC,KAAK,EAAEN,WAAW,CAACM,KAAK;UACxBC,QAAQ,EAAEP,WAAW,CAACO,QAAQ;UAC9BC,WAAW,EAAE,SAAS,IAAIR,WAAW,CAACQ;QAC1C,CAAC;QACDd,OAAO,EAAE;UACL,QAAQ,EAAE,kBAAkB;UAC5B,cAAc,EAAE;QACpB,CAAC;QACDe,eAAe,EAAE;MACrB,CAAC,CAAC;MAEFZ,OAAO,CAACI,GAAG,CAAC,qBAAqB,EAAEC,QAAQ,CAACG,IAAI,CAAC;MAEjD,IAAIH,QAAQ,CAACG,IAAI,IAAIH,QAAQ,CAACG,IAAI,CAAClB,KAAK,IAAIe,QAAQ,CAACG,IAAI,CAACvB,IAAI,EAAE;QAC5D,MAAM;UAAEK,KAAK;UAAEL;QAAK,CAAC,GAAGoB,QAAQ,CAACG,IAAI;;QAErC;QACAjB,YAAY,CAACsB,OAAO,CAAC,OAAO,EAAEvB,KAAK,CAAC;QACpCC,YAAY,CAACsB,OAAO,CAAC,MAAM,EAAEnB,IAAI,CAACoB,SAAS,CAAC7B,IAAI,CAAC,CAAC;;QAElD;QACAT,KAAK,CAACoB,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAAG,UAAUR,KAAK,EAAE;;QAElE;QACAJ,OAAO,CAACD,IAAI,CAAC;;QAEb;QACAP,KAAK,CAACqC,OAAO,CAAC,qBAAqB,CAAC;QAEpC,OAAO;UAAEA,OAAO,EAAE,IAAI;UAAE9B;QAAK,CAAC;MAClC,CAAC,MAAM;QACH,MAAM,IAAI+B,KAAK,CAAC,6BAA6B,CAAC;MAClD;IACJ,CAAC,CAAC,OAAOjB,KAAK,EAAE;MACZC,OAAO,CAACD,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;MAC5C,MAAMA,KAAK;IACf;EACJ,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMkB,MAAM,GAAG3C,WAAW,CAAC,MAAM;IAC7B;IACAiB,YAAY,CAACU,UAAU,CAAC,OAAO,CAAC;IAChCV,YAAY,CAACU,UAAU,CAAC,MAAM,CAAC;IAC/B,OAAOzB,KAAK,CAACoB,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC;IAErDZ,OAAO,CAAC,IAAI,CAAC;IACbR,KAAK,CAACwC,IAAI,CAAC,sCAAsC,CAAC;;IAElD;IACA7B,OAAO,CAAC8B,IAAI,CAAC,QAAQ,CAAC;EAC1B,CAAC,EAAE,CAAC9B,OAAO,CAAC,CAAC;;EAEb;EACA,MAAM+B,QAAQ,GAAG9C,WAAW,CAAC,MAAOmB,QAAQ,IAAK;IAC7C,IAAI;MACA,MAAMY,QAAQ,GAAG,MAAM7B,KAAK,CAAC6C,IAAI,CAAC,oCAAoC,EAAE;QACpE,GAAG5B,QAAQ;QACX6B,qBAAqB,EAAE7B,QAAQ,CAACiB;MACpC,CAAC,CAAC;MAEFhC,KAAK,CAACqC,OAAO,CAAC,gDAAgD,CAAC;MAC/D,OAAO;QAAEA,OAAO,EAAE;MAAK,CAAC;IAC5B,CAAC,CAAC,OAAOhB,KAAK,EAAE;MACZC,OAAO,CAACD,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;MACtD,MAAMA,KAAK;IACf;EACJ,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMwB,eAAe,GAAG,CAAC,CAACtC,IAAI;EAE9B,oBACIL,OAAA,CAACC,WAAW,CAAC2C,QAAQ;IACjBC,KAAK,EAAE;MACHxC,IAAI;MACJE,OAAO;MACPoC,eAAe;MACfrB,KAAK;MACLe,MAAM;MACNG;IACJ,CAAE;IAAArC,QAAA,EAEDA;EAAQ;IAAA2C,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACS,CAAC;AAE/B,CAAC;AAAC7C,EAAA,CAxHWF,YAAY;EAAA,QAGLL,UAAU;AAAA;AAAAqD,EAAA,GAHjBhD,YAAY;AAAA,IAAAgD,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}