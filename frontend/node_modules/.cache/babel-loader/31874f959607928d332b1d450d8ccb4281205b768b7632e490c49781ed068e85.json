{"ast":null,"code":"var _jsxFileName = \"C:\\\\MAMP\\\\htdocs\\\\task-manager-app\\\\frontend\\\\src\\\\context\\\\AuthContext.js\",\n  _s = $RefreshSig$();\nimport React, { createContext, useState, useEffect, useCallback } from 'react';\nimport axios from 'axios';\nimport { useHistory } from 'react-router-dom';\nimport { toast } from 'react-toastify';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext();\nexport const AuthProvider = ({\n  children\n}) => {\n  _s();\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const history = useHistory();\n\n  // Vérifier l'état de connexion au chargement\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    const userData = localStorage.getItem('user');\n    if (token && userData) {\n      try {\n        setUser(JSON.parse(userData));\n        // Configurer l'en-tête d'authentification par défaut\n        axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n      } catch (error) {\n        console.error('Erreur lors du parsing des données utilisateur:', error);\n        localStorage.removeItem('token');\n        localStorage.removeItem('user');\n      }\n    }\n    setLoading(false);\n  }, []);\n\n  // Fonction de connexion\n  const login = useCallback(async credentials => {\n    try {\n      const response = await axios.post('http://127.0.0.1:8000/api/login', {\n        ...credentials,\n        device_name: 'browser'\n      });\n      const {\n        token,\n        user\n      } = response.data;\n\n      // Stocker le token et les données utilisateur\n      localStorage.setItem('token', token);\n      localStorage.setItem('user', JSON.stringify(user));\n\n      // Configurer l'en-tête d'authentification par défaut\n      axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n      setUser(user);\n      toast.success('Connexion réussie !');\n      return {\n        success: true\n      };\n    } catch (error) {\n      console.error('Erreur de connexion:', error);\n      throw error;\n    }\n  }, []);\n\n  // Fonction de déconnexion\n  const logout = useCallback(() => {\n    // Supprimer les données d'authentification\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    delete axios.defaults.headers.common['Authorization'];\n    setUser(null);\n    toast.info('Vous avez été déconnecté avec succès');\n\n    // Rediriger vers la page de connexion\n    history.push('/login');\n  }, [history]);\n\n  // Fonction d'inscription\n  const register = useCallback(async userData => {\n    try {\n      const response = await axios.post('http://127.0.0.1:8000/api/register', {\n        ...userData,\n        password_confirmation: userData.password\n      });\n      toast.success('Inscription réussie ! Veuillez vous connecter.');\n      return {\n        success: true\n      };\n    } catch (error) {\n      console.error('Erreur lors de l\\'inscription:', error);\n      throw error;\n    }\n  }, []);\n\n  // Vérifier si l'utilisateur est authentifié\n  const isAuthenticated = !!user;\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      loading,\n      isAuthenticated,\n      login,\n      logout,\n      register\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 94,\n    columnNumber: 9\n  }, this);\n};\n_s(AuthProvider, \"8di1RvVO9OMJYUpZq8Z48NhIhRY=\", false, function () {\n  return [useHistory];\n});\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","useCallback","axios","useHistory","toast","jsxDEV","_jsxDEV","AuthContext","AuthProvider","children","_s","user","setUser","loading","setLoading","history","token","localStorage","getItem","userData","JSON","parse","defaults","headers","common","error","console","removeItem","login","credentials","response","post","device_name","data","setItem","stringify","success","logout","info","push","register","password_confirmation","password","isAuthenticated","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/MAMP/htdocs/task-manager-app/frontend/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect, useCallback } from 'react';\nimport axios from 'axios';\nimport { useHistory } from 'react-router-dom';\nimport { toast } from 'react-toastify';\n\nexport const AuthContext = createContext();\n\nexport const AuthProvider = ({ children }) => {\n    const [user, setUser] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const history = useHistory();\n\n    // Vérifier l'état de connexion au chargement\n    useEffect(() => {\n        const token = localStorage.getItem('token');\n        const userData = localStorage.getItem('user');\n        \n        if (token && userData) {\n            try {\n                setUser(JSON.parse(userData));\n                // Configurer l'en-tête d'authentification par défaut\n                axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n            } catch (error) {\n                console.error('Erreur lors du parsing des données utilisateur:', error);\n                localStorage.removeItem('token');\n                localStorage.removeItem('user');\n            }\n        }\n        \n        setLoading(false);\n    }, []);\n\n    // Fonction de connexion\n    const login = useCallback(async (credentials) => {\n        try {\n            const response = await axios.post('http://127.0.0.1:8000/api/login', {\n                ...credentials,\n                device_name: 'browser'\n            });\n            \n            const { token, user } = response.data;\n            \n            // Stocker le token et les données utilisateur\n            localStorage.setItem('token', token);\n            localStorage.setItem('user', JSON.stringify(user));\n            \n            // Configurer l'en-tête d'authentification par défaut\n            axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n            \n            setUser(user);\n            toast.success('Connexion réussie !');\n            \n            return { success: true };\n        } catch (error) {\n            console.error('Erreur de connexion:', error);\n            throw error;\n        }\n    }, []);\n\n    // Fonction de déconnexion\n    const logout = useCallback(() => {\n        // Supprimer les données d'authentification\n        localStorage.removeItem('token');\n        localStorage.removeItem('user');\n        delete axios.defaults.headers.common['Authorization'];\n        \n        setUser(null);\n        toast.info('Vous avez été déconnecté avec succès');\n        \n        // Rediriger vers la page de connexion\n        history.push('/login');\n    }, [history]);\n\n    // Fonction d'inscription\n    const register = useCallback(async (userData) => {\n        try {\n            const response = await axios.post('http://127.0.0.1:8000/api/register', {\n                ...userData,\n                password_confirmation: userData.password\n            });\n            \n            toast.success('Inscription réussie ! Veuillez vous connecter.');\n            return { success: true };\n        } catch (error) {\n            console.error('Erreur lors de l\\'inscription:', error);\n            throw error;\n        }\n    }, []);\n\n    // Vérifier si l'utilisateur est authentifié\n    const isAuthenticated = !!user;\n\n    return (\n        <AuthContext.Provider \n            value={{ \n                user, \n                loading, \n                isAuthenticated,\n                login, \n                logout, \n                register \n            }}\n        >\n            {children}\n        </AuthContext.Provider>\n    );\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}